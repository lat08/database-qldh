@startuml
!theme plain
top to bottom direction
skinparam classAttributeIconSize 0
skinparam linetype ortho

skinparam class {
  BackgroundColor LightBlue
  BorderColor Blue
}

' Level 0 tables
class admin {
  admin_id
  person_id
  admin_code
  position
  admin_status
  created_at
  updated_at
  created_by
  updated_by
  is_deleted
  is_active
}
class curriculum_detail {
  curriculum_detail_id
  department_id
  subject_id
  semester_id
  created_at
  updated_at
  created_by
  updated_by
  is_deleted
  is_active
}
class department {
  department_id
  department_name
  department_code
  faculty_id
  head_of_department_id
  created_at
  updated_at
  created_by
  updated_by
  is_deleted
  is_active
}
class document {
  document_id
  course_class_id
  file_name
  file_path
  file_type
  file_size
  uploaded_by
  description
  created_at
  updated_at
  created_by
  updated_by
  is_deleted
  is_active
}
class exam_class {
  exam_class_id
  exam_id
  course_class_id
  room_id
  monitor_instructor_id
  start_time
  duration_minutes
  exam_status
  created_at
  updated_at
  created_by
  updated_by
  is_deleted
  is_active
}
class faculty {
  faculty_id
  faculty_name
  faculty_code
  dean_id
  faculty_status
  created_at
  updated_at
  created_by
  updated_by
  is_deleted
  is_active
}
class notification_schedule {
  schedule_id
  notification_type
  title
  content
  scheduled_date
  visible_from
  is_read
  target_type
  target_id
  created_by_user
  status
  created_at
  updated_at
  is_deleted
  is_active
}
class payment {
  payment_id
  student_id
  payment_type
  enrollment_id
  insurance_id
  amount
  payment_date
  payment_method
  notes
  created_at
  updated_at
  created_by
  updated_by
  is_deleted
  is_active
  CONSTRAINT
}
class permission {
  permission_id
  role_name
  permission_name
  description
  created_at
  updated_at
  created_by
  updated_by
  is_deleted
  is_active
}
class room_booking {
  booking_id
  room_id
  booking_type
  booking_date
  start_time
  end_time
  booked_by
  purpose
  booking_status
  created_at
  updated_at
  created_by
  updated_by
  is_deleted
  is_active
  CONSTRAINT
}
class schedule_change {
  schedule_change_id
  course_class_id
  cancelled_week
  makeup_week
  makeup_date
  makeup_room_id
  day_of_week
  start_period
  end_period
  reason
  created_at
  updated_at
  created_by
  updated_by
  is_deleted
  is_active
  CONSTRAINT
}
class subject {
  subject_id
  subject_name
  subject_code
  credits
  theory_hours
  practice_hours
  is_general
  department_id
  prerequisite_subject_id
  subject_status
  created_at
  updated_at
  created_by
  updated_by
  is_deleted
  is_active
}
class user_otp {
  otp_id
  user_id
  otp_code
  expired_at
  is_used
  created_at
}
class user_refresh_token {
  token_id
  user_id
  refresh_token
  expires_at
  is_revoked
  created_at
}

' Level 1 tables
class exam {
  exam_id
  course_id
  exam_format
  exam_type
  exam_file_pdf
  answer_key_pdf
  notes
  is_approved
  created_at
  updated_at
  created_by
  updated_by
  is_deleted
  is_active
}
class student_enrollment {
  enrollment_id
  student_id
  course_class_id
  enrollment_date
  enrollment_status
  cancellation_date
  cancellation_reason
  attendance_grade
  midterm_grade
  final_grade
  is_paid
  created_at
  updated_at
  created_by
  updated_by
  is_deleted
  is_active
  CONSTRAINT
}
class student_health_insurance {
  insurance_id
  student_id
  academic_year_id
  insurance_fee
  start_date
  end_date
  insurance_status
  is_paid
  created_at
  updated_at
  created_by
  updated_by
  is_deleted
  is_active
  CONSTRAINT
  CONSTRAINT
}
class user_account {
  user_id
  person_id
  username
  password_hash
  password_salt
  role_name
  email_verified
  email_verification_code
  account_status
  last_login_time
  created_at
  updated_at
  created_by
  updated_by
  is_deleted
  is_active
}

' Level 2 tables
class course_class {
  course_class_id
  course_id
  instructor_id
  room_id
  date_start
  date_end
  max_students
  day_of_week
  start_period
  end_period
  course_class_status
  created_at
  updated_at
  created_by
  updated_by
  is_deleted
  is_active
  CONSTRAINT
  CONSTRAINT
}
class student {
  student_id
  person_id
  student_code
  class_id
  enrollment_status
  created_at
  updated_at
  created_by
  updated_by
  is_deleted
  is_active
}

' Level 3 tables
class class {
  class_id
  class_code
  class_name
  department_id
  advisor_instructor_id
  start_academic_year_id
  end_academic_year_id
  curriculum_desc_pdf
  class_status
  created_at
  updated_at
  created_by
  updated_by
  is_deleted
  is_active
}
class course {
  course_id
  subject_id
  semester_id
  fee_per_credit
  course_status
  created_at
  updated_at
  created_by
  updated_by
  is_deleted
  is_active
}
class room {
  room_id
  room_code
  room_name
  capacity
  room_type
  building_id
  room_status
  created_at
  updated_at
  created_by
  updated_by
  is_deleted
  is_active
}

' Level 4 tables
class building {
  building_id
  building_name
  building_code
  address
  building_status
  created_at
  updated_at
  created_by
  updated_by
  is_deleted
  is_active
}
class instructor {
  instructor_id
  person_id
  instructor_code
  degree
  specialization
  department_id
  hire_date
  employment_status
  created_at
  updated_at
  created_by
  updated_by
  is_deleted
  is_active
}
class semester {
  semester_id
  semester_name
  academic_year_id
  semester_type
  start_date
  end_date
  registration_start_date
  registration_end_date
  semester_status
  created_at
  updated_at
  created_by
  updated_by
  is_deleted
  is_active
  CONSTRAINT
  CONSTRAINT
  CONSTRAINT
}

' Level 5 tables
class academic_year {
  academic_year_id
  year_name
  start_date
  end_date
  academic_year_status
  created_at
  updated_at
  created_by
  updated_by
  is_deleted
  is_active
  CONSTRAINT
}
class person {
  person_id
  full_name
  date_of_birth
  gender
  email
  phone_number
  citizen_id
  address
  profile_picture
  created_at
  updated_at
  created_by
  updated_by
  is_deleted
  is_active
}

' Relationships
person --> user_account
user_account --> user_otp
user_account --> user_refresh_token
building --> room
academic_year --> semester
faculty --> department
person --> instructor
department --> instructor
department --> subject
department --> class
instructor --> class
academic_year --> class
person --> student
class --> student
person --> admin
department --> curriculum_detail
subject --> curriculum_detail
semester --> curriculum_detail
subject --> course
semester --> course
course --> course_class
instructor --> course_class
room --> course_class
student --> student_enrollment
course_class --> student_enrollment
course_class --> schedule_change
room --> schedule_change
course_class --> document
instructor --> document
user_account --> notification_schedule
course --> exam
exam --> exam_class
course_class --> exam_class
room --> exam_class
instructor --> exam_class
student --> student_health_insurance
academic_year --> student_health_insurance
student --> payment
student_enrollment --> payment
student_health_insurance --> payment
room --> room_booking
user_account --> room_booking
@enduml